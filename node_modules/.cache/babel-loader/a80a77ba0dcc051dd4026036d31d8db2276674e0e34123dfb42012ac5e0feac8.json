{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect } from \"react\";\nimport axios from \"./axiosInstance\";\nimport useAuth from \"../auth/useAuth\";\nconst AxiosInterceptor = () => {\n  _s();\n  const {\n    accessToken,\n    refreshAccessToken,\n    logout\n  } = useAuth();\n  useEffect(() => {\n    const requestInterceptor = axios.interceptors.request.use(config => {\n      if (accessToken) {\n        config.headers.Authorization = `Bearer ${accessToken}`;\n      }\n      return config;\n    }, error => Promise.reject(error));\n    const responseInterceptor = axios.interceptors.response.use(response => response, async error => {\n      var _error$response;\n      const originalRequest = error.config;\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 403) {\n        const newToken = await refreshAccessToken();\n        if (newToken) {\n          originalRequest.headers.Authorization = `Bearer ${newToken}`;\n          return axios(originalRequest);\n        } else {\n          logout();\n        }\n      }\n      return Promise.reject(error);\n    });\n    return () => {\n      axios.interceptors.request.eject(requestInterceptor);\n      axios.interceptors.response.eject(responseInterceptor);\n    };\n  }, [accessToken, refreshAccessToken, logout]);\n  return null;\n};\n_s(AxiosInterceptor, \"39opb1bCQ9QHK39uA2ZMkSSZfhI=\", false, function () {\n  return [useAuth];\n});\n_c = AxiosInterceptor;\nexport default AxiosInterceptor;\nvar _c;\n$RefreshReg$(_c, \"AxiosInterceptor\");","map":{"version":3,"names":["useEffect","axios","useAuth","AxiosInterceptor","_s","accessToken","refreshAccessToken","logout","requestInterceptor","interceptors","request","use","config","headers","Authorization","error","Promise","reject","responseInterceptor","response","_error$response","originalRequest","status","newToken","eject","_c","$RefreshReg$"],"sources":["C:/Weeaboo/notes-frontend/src/api/axiosInterceptor.js"],"sourcesContent":["import { useEffect } from \"react\";\r\nimport axios from \"./axiosInstance\";\r\nimport useAuth from \"../auth/useAuth\";\r\n\r\nconst AxiosInterceptor = () => {\r\n  const { accessToken, refreshAccessToken, logout } = useAuth();\r\n\r\n  useEffect(() => {\r\n    const requestInterceptor = axios.interceptors.request.use(\r\n      (config) => {\r\n        if (accessToken) {\r\n          config.headers.Authorization = `Bearer ${accessToken}`;\r\n        }\r\n        return config;\r\n      },\r\n      (error) => Promise.reject(error)\r\n    );\r\n\r\n    const responseInterceptor = axios.interceptors.response.use(\r\n      (response) => response,\r\n      async (error) => {\r\n        const originalRequest = error.config;\r\n\r\n        if (error.response?.status === 403) {\r\n          const newToken = await refreshAccessToken();\r\n\r\n          if (newToken) {\r\n            originalRequest.headers.Authorization = `Bearer ${newToken}`;\r\n            return axios(originalRequest);\r\n          } else {\r\n            logout();\r\n          }\r\n        }\r\n\r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n\r\n    return () => {\r\n      axios.interceptors.request.eject(requestInterceptor);\r\n      axios.interceptors.response.eject(responseInterceptor);\r\n    };\r\n  }, [accessToken, refreshAccessToken, logout]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default AxiosInterceptor;\r\n"],"mappings":";AAAA,SAASA,SAAS,QAAQ,OAAO;AACjC,OAAOC,KAAK,MAAM,iBAAiB;AACnC,OAAOC,OAAO,MAAM,iBAAiB;AAErC,MAAMC,gBAAgB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC7B,MAAM;IAAEC,WAAW;IAAEC,kBAAkB;IAAEC;EAAO,CAAC,GAAGL,OAAO,CAAC,CAAC;EAE7DF,SAAS,CAAC,MAAM;IACd,MAAMQ,kBAAkB,GAAGP,KAAK,CAACQ,YAAY,CAACC,OAAO,CAACC,GAAG,CACtDC,MAAM,IAAK;MACV,IAAIP,WAAW,EAAE;QACfO,MAAM,CAACC,OAAO,CAACC,aAAa,GAAG,UAAUT,WAAW,EAAE;MACxD;MACA,OAAOO,MAAM;IACf,CAAC,EACAG,KAAK,IAAKC,OAAO,CAACC,MAAM,CAACF,KAAK,CACjC,CAAC;IAED,MAAMG,mBAAmB,GAAGjB,KAAK,CAACQ,YAAY,CAACU,QAAQ,CAACR,GAAG,CACxDQ,QAAQ,IAAKA,QAAQ,EACtB,MAAOJ,KAAK,IAAK;MAAA,IAAAK,eAAA;MACf,MAAMC,eAAe,GAAGN,KAAK,CAACH,MAAM;MAEpC,IAAI,EAAAQ,eAAA,GAAAL,KAAK,CAACI,QAAQ,cAAAC,eAAA,uBAAdA,eAAA,CAAgBE,MAAM,MAAK,GAAG,EAAE;QAClC,MAAMC,QAAQ,GAAG,MAAMjB,kBAAkB,CAAC,CAAC;QAE3C,IAAIiB,QAAQ,EAAE;UACZF,eAAe,CAACR,OAAO,CAACC,aAAa,GAAG,UAAUS,QAAQ,EAAE;UAC5D,OAAOtB,KAAK,CAACoB,eAAe,CAAC;QAC/B,CAAC,MAAM;UACLd,MAAM,CAAC,CAAC;QACV;MACF;MAEA,OAAOS,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;IAC9B,CACF,CAAC;IAED,OAAO,MAAM;MACXd,KAAK,CAACQ,YAAY,CAACC,OAAO,CAACc,KAAK,CAAChB,kBAAkB,CAAC;MACpDP,KAAK,CAACQ,YAAY,CAACU,QAAQ,CAACK,KAAK,CAACN,mBAAmB,CAAC;IACxD,CAAC;EACH,CAAC,EAAE,CAACb,WAAW,EAAEC,kBAAkB,EAAEC,MAAM,CAAC,CAAC;EAE7C,OAAO,IAAI;AACb,CAAC;AAACH,EAAA,CAzCID,gBAAgB;EAAA,QACgCD,OAAO;AAAA;AAAAuB,EAAA,GADvDtB,gBAAgB;AA2CtB,eAAeA,gBAAgB;AAAC,IAAAsB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}